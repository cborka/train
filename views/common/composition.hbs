<h1>Состав изделий</h1>
<p>Из чего состоит изделие/продукт<br></p>
<form name="compositions" action="/common/composition_update" method="POST">
    <table class="form">
        <tr>
            <td><label>Изделие:</label></td>
            <td><select width="100%" size="1" name='product_name' id='product_name' value="{{product_name}}"></select>
                <input id="product_rf" type="text" name="product_rf" readonly value={{product_rf}} hidden >
                <input id="old_product_rf" type="text" name="old_product_rf" readonly value={{product_rf}} hidden >
            </td>
        </tr>
        <tr>
            <td><label>Компонент:</label></td>
            <td><select width="100%" size="1" name='component_name' id='component_name' value="{{component_name}}"></select>
                <input id="component_rf" type="text" name="component_rf" readonly value={{component_rf}} hidden >
                <input id="old_component_rf" type="text" name="old_component_rf" readonly value={{component_rf}} hidden >
            </td>
        </tr>
        <tr>
            <td><label>Количество:</label></td>
            <td><input id="amount" type="number" size="5" step="0.001" name="amount" value={{amount}} ></td>
        </tr>
        <tr>
            <td><label>Единица измерения:</label></td>
            <td><select width="100%" size="1" name='unit_name' id='unit_name' value="{{unit_name}}"></select>
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <button type="submit" >Сохранить</button>
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <div id="hint" ></div>
                <div id="erro" ></div>
            </td>
        </tr>
    </table>
</form>

<script>

    // Изготовить список изделий для выбора
    var set_product_names = function (reply)
    {
        document.getElementById("product_name").innerHTML = reply;
        document.getElementById("product_name").value = '{{product_name}}';
    }
    function get_product_names()
    {
        doQuery ("/common/get_product_names", set_product_names);
    }

    // Изготовить список компонентов для выбора
    var set_component_names = function (reply)
    {
        document.getElementById("component_name").innerHTML = reply;
        document.getElementById("component_name").value = '{{component_name}}';
    }
    function get_component_names()
    {
        doQuery ("/common/get_component_names", set_component_names);
    }

    // Изготовить список единиц измерения для выбора
    var set_unit_names = function (reply)
    {
        document.getElementById("unit_name").innerHTML = reply;
        document.getElementById("unit_name").value = '{{unit_name}}';
    }
    function get_unit_names()
    {
        doQuery ("/common/get_spr_names/Единицы", set_unit_names);
    }


    get_product_names();
    get_component_names();
    get_unit_names();

</script>