
<div style='overflow: auto;'>
  <div style='float: left; overflow: auto;'>
    <h1>{{header}}</h1>
  </div>

  <div style='float: right; overflow: auto;'>
    <button id="btnOnOff" type="button" style="float: right" onclick="auto_on()">Включить часы</button>
    <br><br>
    <div id="datetime" style="float: right; color: green; font-weight: bold; font-size: larger" ></div>
  </div>
</div>



<br>
<!--
<table class="form">
    <tr>
        <td><label>Дата:</label></td>
        <td><input id="dt" type="date" pattern='[0-9]{4}-[0-9]{2}-[0-9]{2}' name="dt" value="" ></td>
        <td><button type="button" onclick="set_now()">Сегодня</button></td>
        <td><button type="button" onclick="get_formovka()">Формовка</button></td>
    </tr>
</table>
-->

<table>
  <tr class="reports"><td align="left">

    <div style='overflow: auto;'>
        <h2>Формовка</h2>
       <button id="btnFormovkaOnOff" type="button"  onclick="formovka_auto_on()">Включить автообновление</button>
    </div>
      <br>
    <div id="formovka" align="left" style='float: left; overflow: auto;'></div>

  </td></tr><tr class="reports"><td>

     <h2>СГП</h2>
    <div id="sklad_fc" ></div>

    </td></tr><tr class="reports"><td>

    <h2>Арматура</h2>
    <div id="fc_arm" ></div>



    </td></tr>
</table>

<div id="hint" >_</div>
<div id="erro" >_</div>

<!--
<table class="report" align="left" align="left">
    <tr><td class="report">ЖБИ</td>
        <td class="report left">Вчера</td>
        <td class="report left">Сегодня</td>
        <td class="report left">Завтра</td>
    </tr>
</table><br>
-->

<script>
    var timerId = 0;
    var timerFormovkaId = 0;
    var dtNow = new Date();;
    var dtNowAsString= toYYYYMMDDHHMMSS(dtNow);

    function auto_on()
    {
        if (timerId <= 0) {
            timerId = setInterval(show_info, 1000);
            document.getElementById("btnOnOff").innerHTML = 'Выключить часы';
        }
        else if (timerId > 0) {
            clearInterval(timerId);
            timerId = 0;

            document.getElementById("btnOnOff").innerHTML = 'Включить часы';
            document.getElementById("datetime").innerHTML = '' ;
        }
    }


    // Перерисовка данных на странице (или можно для каждого блока задать свой интервал)
    function show_info()
    {
        dtNow = new Date();
        document.getElementById("datetime").innerHTML = dtNowAsString = toYYYYMMDDHHMMSS(dtNow);
    }

    function set_now()
    {
        document.getElementById("dt").value = '2019-01-29';
    }


    function formovka_auto_on()
    {
        if (timerFormovkaId <= 0) {
            get_formovka();
            timerFormovkaId = setInterval(get_formovka, 5000);
            document.getElementById("btnFormovkaOnOff").innerHTML = 'Выключить автообновление';
        }
        else if (timerFormovkaId > 0) {
            clearInterval(timerFormovkaId);
            timerFormovkaId = 0;
            document.getElementById("btnFormovkaOnOff").innerHTML = 'Включить автообновление';
            document.getElementById("formovka").innerHTML = '';
        }
    }





    // Запросить и показать формовку за дату
    var set_formovka = function (reply)
    {
        document.getElementById("formovka").innerHTML = reply;
    }
    function get_formovka()
    {
        document.getElementById("formovka").innerHTML = '';

        doQuery ("/reports/get_formovka", set_formovka,
                '&dt=' + encodeURIComponent(dtNowAsString.substr(0, 10))
//        '&dt=' + encodeURIComponent(document.getElementById("dt").value.substr(0, 10))
        );
    }


    // Изготовить список дат для выбора
    var set_date = function (reply)
    {
        document.getElementById("sd_name").innerHTML = reply;
        document.getElementById("sd_name").value = '{{sd_name}}';
    }
    function get_date()
    {
        doQuery ("/report/Даты", set_date);
    }


</script>